### Асинхронный асинхронный сервер, отправляющий в вебсокет текущие значения валютных пар.

### Запуск

    make run


### Остановка 

    make stop

### Запуск тестов 

    make test


### Краткое описание

Front-end для работы с websocket выставлен по адресу: http://127.0.0.1:8080

Сам websocket слушает: http://127.0.0.1:8080/ws


#### Из чего состоит проект:
В общем проект состоит из нескольких частей:
* фоновая задача для обновления валютных пар и с передачей актуальных значений в шину данных
* фоновая задача для отправки актуальных данных подписчикам в открытый сокет
* адаптер для обработки действий юзера
* блок логики для обеспечения всех пунтков выше

#### Требуемые улучшения при дальнейшем масштобировании:

* Под шину данных для хранения актуальных значений точек лучше завести кэш систему, например Redis
* Фоновое обновление пар лучше делать в шедуллере вроде Celery, т.к. при масштабировании приложения, 
фоновые задачи начнут работать в нескольких инстансах, что даст неприятный эффект


#### Нерешенные проблемы

При запуске всех тестов, после прохождения первого, работающего с БД возникает 
`RuntimeError ... attached to a different loop`, что судя по всему означает, что между тестами стартует разный ивент луп, 
и асинхронные вызовы в БД, видимо не используют тот же контекст, что при инициализации. 
Информации о подобных проблемах при запуске тестов мало, что требует погружения в проблему.

При этом одиночные тесты, запускаемые по отдельности, успешно проходят.

#### Пример взаимодействия

![Example](https://github.com/ZinBu/currency-subscriber/blob/master/example/img.png)
